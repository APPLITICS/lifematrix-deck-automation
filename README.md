# Automated Graph Generation (part of Phase 3)

## Overview

This README describes the process for generating charts in R based on a structured list of instructions and provided data.
The resulting graphs match those presented in the accompanying PowerPoint file and are part of the automated slide generation workflow introduced in Phase 2.

## Directory Structure
```
R/
├── bar_chart_function.R       # Generates bar charts based on instruction input
├── density_chart_function.R   # Generates density charts based on instruction input
├── helpers.R                  # Shared helper functions (e.g., theme)
├── instructions.R             # Contains example instruction lists

simulated_data/
├── bar_data.csv               # Sample data for bar chart generation
├── density_data.csv           # Sample data for density chart generation

README.md                      
main.R                         # Main execution script for rendering graph examples
automation.pptx                # Reference presentation for chart layout
```
## Graph Generative Functions
Each graph is generated by a dedicated function based on its chart type making each slide fully self-contained.

### A. Density Graphs with Average

**Used In**: Slides 3–5, 29–52, 57–58  

**Function**:  
```r
draw_density_chart(data, instruction)
```

#### Description

- Generates a density plot for a given metric (e.g., `life_satisfaction`, `sleep_hours`) for the focal group.  
- The focal group’s average is marked with a vertical dashed line, while comparison group averages are highlighted in green annotation boxes for clear benchmarking.

#### Characterstics of the `instruction` input

- `slide`: Slide number.
- `slide_type`: `"density_chart"`
- `metric`: Name of the targeted metric to plot.
- `title`: Slide title.
- `unit`: Unit (e.g., `%`, `NULL`, `"hours"`).
- `x_title`: X-axis label.
- `y_title`: Y-axis label.
- `focal_group`: List with `name` and optional `subset` (1 level is allowed) - `NULL` for `subset` if no subsetting.
- `comparison_groups`: List of comparison groups or `NULL`.

#### Example `instructions` for Slide 3: Focal Group without Comparison Groups

```r
instructions <- list(
  list(
    slide             = 3,
    slide_type        = "density_chart",
    metric            = "life_satisfaction",
    title             = "Life Satisfaction",
    unit              = NULL,
    x_title           = "Life Satisfaction",
    y_title           = "Density",
    focal_group       = list(name = focal_group, subset = NULL),
    comparison_groups = NULL
  )
)
```

#### Example `instructions` for Slide 5: Focal Group without Comparison Groups

```r
instructions <- list(
  list(
    slide             = 3,
    slide_type        = "density_chart",
    metric            = "life_satisfaction",
    title             = "Life Satisfaction",
    unit              = NULL,
    x_title           = "Life Satisfaction",
    y_title           = "Density",
    focal_group       = list(name = focal_group, subset = NULL),
    comparison_groups = list(
      list(name = comparison_group_1, subset = list(title = "gender", value = "Women")),
      list(name = comparison_group_1, subset = list(title = "gender", value = "men"))
    ),
  )
)
```
---

### B. Bar Graphs

**Used In**: Slides 8–22, 60-65, 67, 73, 74

**Function**:  
```r
draw_bar_chart(data, instruction)
```

#### Description

- Generates a grouped bar chart based on `metric` values across focal and comparison groups with the possibility of adding an optional dahsed line for the target values.
- Handles both percentage (`unit = "%"`) and numeric score (`unit = "score"`) values and updating bars and y-axis accordingly.
- The second comparison group is set to `NA` used intentionally as a placeholder to reserve layout space in the chart **(Build Scenario)**.
- Adds an optional trend line across bar heights to highlight patterns across categories or metrics.
- Supports single or multiple metrics and custom x-axis categories (e.g., `gender`, `reunion class`).

#### Characterstics of the `instruction` input

- `slide`: Slide number.
- `slide_type`: `"bar_chart"`
- `metrics`: A vector of metrics to display.
- `title`: Slide title.
- `unit`: Unit (e.g. `"%"`, `"score"`).
- `x_title`: X-axis title.
- `y_title`: Y-axis title.
- `legend`: Whether to show a legend.
- `focal_group`: List with `name` and optional `subset` (1 level is allowed) - `NULL` for `subset` if no subsetting.
- `comparison_groups`: List of group definitions. Use `name = NA` for placeholders.
- `current_value`: Bar current value to be displayed.
- `target`: Bar target value to be displayed with dashed lines.
- `trend_line`: Whether to include a trend line.

#### Example `instructions` of Slide 12 with focal group override and `NA` comparison slot

```r
instructions <- list(
  list(
    slide             = 12,
    slide_type        = "bar_chart",
    metric            = c("Joy", "Achievement", "Meaningfulness"),
    category          = NULL,
    unit              = "%",
    x_title           = NULL,
    y_title           = "% High Importance",
    title             = "IMPORTANCE OF JAM",
    focal_group       = list(name = focal_group, subset = NULL),
    comparison_groups = list(
      list(
        name   = comparison_group_1,
        subset = list(title = "gender", value = "Women")
      ),
      list(name = NA, subset = NULL)
    ),
    current_value      = "metric_value",
    target            = NULL,
    trend_line        = NULL
  )
)
```
#### Example `instructions` of Slide 18  focal group with two comparison groups with gender subsets and target values 
```r
instructions <- list(
   list(
    slide             = 18,
    slide_type        = "bar_chart",
    metric            = c("Joy", "Achievement", "Meaningfulness"),
    category          = NULL,
    unit              = "%",
    x_title           = NULL,
    y_title           = "% High Importance",
    title             = "IMPORTANCE OF JAM",
    focal_group       = list(name = focal_group, subset = NULL),
    comparison_groups = list(
      list(
        name   = comparison_group_1,
        subset = list(title = "gender", value = "Women")
      ),
      list(
        name   = comparison_group_1,
        subset = list(title = "gender", value = "Men")
      )
    ),
    current_value      = "metric_value",
    target            = "munimums_value",
    trend_line        = NULL
  )
)
```